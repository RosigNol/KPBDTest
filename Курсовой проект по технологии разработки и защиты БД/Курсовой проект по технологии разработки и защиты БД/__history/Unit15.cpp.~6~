//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "Unit15.h"
#include "Unit16.h"
#include "Unit17.h"
#include "Unit18.h"
#include "Unit6.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma link "sSkinManager"
#pragma link "sButton"
#pragma link "sEdit"
#pragma link "sLabel"
#pragma link "sPageControl"
#pragma link "sPanel"
#pragma link "frxDCtrl"
#pragma link "frxADOComponents"
#pragma resource "*.dfm"
#pragma resource "КП_resources.RES"
TForm1 *Form1;
//---------------------------------------------------------------------------
__fastcall TForm1::TForm1(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------

void __fastcall TForm1::FormCreate(TObject *Sender)
{
   /////////////////////////////
   Form1->sLabel1->Caption="Ввод номера студенческого билета и фамилии студента:";
   Form1->sEdit1->Text="Введите номер Вашего студенческого билета!";
   Form1->sEdit2->Text="Введите Вашу фамилию!";
   Form1->sButton1->Caption=("Войти в учетную запись.");
   Form1->sButton2->Caption=("Регистрация нового студента.");
   Form1->sLabel2->Caption=("или");
   /////////////////////////////
   Form1->sLabel3->Caption=("Ввод логина и пароля учительской учетной записи:");
   Form1->sEdit3->Text=("Введите Ваш логин!");
   Form1->sEdit4->Text=("Введите Вам пароль!");
   Form1->sButton3->Caption=("Войти в учетную запись.");
   Form1->sButton4->Caption=("Регистрация нового учителя.");
   Form1->sLabel4->Caption=("или");
   /////////////////////////////
   Graphics::TBitmap *ptBitmap;
   ptBitmap=new Graphics::TBitmap();
   TResourceStream* ptRes =
   new TResourceStream((int)HInstance, "BITMAP1",L"RT_BITMAP");
   ptBitmap->LoadFromStream(ptRes);
   Image1->Picture->Assign((TPersistent*)ptBitmap);
   Image2->Picture->Assign((TPersistent*)ptBitmap);
   ////////////////////////////////////////////////////////////////
   Graphics::TBitmap *ptBitmap1;
   ptBitmap1=new Graphics::TBitmap();
   TResourceStream* ptRes1 =
   new TResourceStream((int)HInstance, "BITMAP2",L"RT_BITMAP");
   ptBitmap1->LoadFromStream(ptRes1);
}
//---------------------------------------------------------------------------


//---------------------------------------------------------------------------

void __fastcall TForm1::sEdit1Click(TObject *Sender)
{
   Form1->sEdit1->Text="";
}
//---------------------------------------------------------------------------

void __fastcall TForm1::sEdit2Click(TObject *Sender)
{
   Form1->sEdit2->Text="";
}
//---------------------------------------------------------------------------

void __fastcall TForm1::sEdit3Click(TObject *Sender)
{
   Form1->sEdit3->Text="";
}
//---------------------------------------------------------------------------

void __fastcall TForm1::sEdit4Click(TObject *Sender)
{
  Form1->sEdit4->Text="";
}
//---------------------------------------------------------------------------


void __fastcall TForm1::sButton1Click(TObject *Sender)
{
   //DataModule1->ADOStoredProc1->ProcedureName="TransProvStudent;1";
   DataModule1->ADOStoredProc1->Parameters->ParamByName("@fam")->Value=(Form1->sEdit2->Text);
   DataModule1->ADOStoredProc1->Parameters->ParamByName("@NumberStudentTicket")->Value=(Form1->sEdit1->Text);
   DataModule1->ADOStoredProc1->ExecProc();
   if (DataModule1->ADOStoredProc1->Parameters->ParamValues["@char"]=="y")
   {
	   Form1->Visible=false;
	   Form2->Visible=true;
   }

}
//---------------------------------------------------------------------------
//---------------------------------------------------------------------------

void __fastcall TForm1::sButton2Click(TObject *Sender)
{
	Form3->Visible=true;
	Form1->Visible=false;
}
//---------------------------------------------------------------------------

void __fastcall TForm1::sButton3Click(TObject *Sender)
{
   DataModule1->ADOStoredProc2->Parameters->ParamByName("@login")->Value=(Form1->sEdit3->Text);
   DataModule1->ADOStoredProc2->Parameters->ParamByName("@password")->Value=(Form1->sEdit4->Text);
   DataModule1->ADOStoredProc2->ExecProc();
   if (DataModule1->ADOStoredProc2->Parameters->ParamValues["@char"]=="y")
   {
	   Form1->Hide();
	   Form6->ShowModal(); //Вставить код новой формы.
   }
}
//---------------------------------------------------------------------------

void __fastcall TForm1::sButton4Click(TObject *Sender)
{
   //Form3->ShowModal(); Вставить код новой формы
   //Form1->Hide();
}
//---------------------------------------------------------------------------

